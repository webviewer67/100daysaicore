<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üî• 100 Day AI PRO MAX ULTRA - Gen Z Edition</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:white;
}
.container{
  max-width:520px;
  margin:auto;
  padding:20px;
  position:relative;
}
h2,h3,h4{margin:8px 0;}
.calendar{
  position:absolute;
  right:20px;
  top:20px;
  font-size:26px;
  cursor:pointer;
  transition: transform 0.3s;
}
.calendar:hover{transform:scale(1.2);}
.card{
  background:rgba(255,255,255,0.08);
  padding:20px;
  border-radius:20px;
  margin-top:20px;
  backdrop-filter:blur(12px);
  box-shadow: 0 0 15px rgba(0,0,0,0.3);
  transition: transform 0.3s;
}
.card:hover{transform:translateY(-3px);}
button,input,select,textarea{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:12px;
  border:none;
  font-size:15px;
  outline:none;
}
button{
  background:#ff416c;
  color:white;
  font-weight:bold;
  cursor:pointer;
  transition:all 0.2s;
}
button:hover{
  transform:scale(1.02);
  opacity:0.95;
}
#xpBar{
  height:14px;
  background:#222;
  border-radius:10px;
  overflow:hidden;
  margin-top:10px;
  box-shadow: 0 0 6px #00f260 inset, 0 0 6px #0575e6 inset;
}
#xpFill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#00f260,#0575e6);
  transition:width 0.6s ease;
}
.badge{
  display:inline-block;
  background:#ffcc00;
  color:black;
  padding:6px 12px;
  border-radius:20px;
  font-size:12px;
  margin:5px 5px 0 0;
  box-shadow:0 0 4px #ffcc00;
  transition: transform 0.2s;
}
.badge:hover{transform:scale(1.1);}
.notification{
  position:fixed;
  right:10px;
  top:40%;
  background:#00c853;
  padding:14px;
  border-radius:12px;
  display:none;
  font-weight:bold;
  z-index:999;
  box-shadow:0 0 10px #00c853;
}
.taskItem{
  margin:8px 0;
  display:flex;
  align-items:center;
}
.taskItem input{margin-right:10px; transform:scale(1.2);}
.aiBox{
  margin-top:10px;
  display:flex;
  gap:5px;
}
.aiInput{flex:1; padding:10px; border-radius:10px;}
.aiButton{width:80px; background:#00f260; color:#000; font-weight:bold; transition:all 0.2s;}
.aiButton:hover{transform:scale(1.05);}
#aiResponse{
  margin-top:10px;
  background:rgba(0,0,0,0.3);
  padding:12px;
  border-radius:12px;
  min-height:50px;
  font-style:italic;
}
</style>
</head>
<body>

<div class="container">

<div class="calendar" onclick="showHistory()">üìÖ</div>

<h2>üî• 100 Day AI PRO MAX ULTRA - Gen Z Edition</h2>

<!-- Setup -->
<div id="setup" class="card">
<input id="nameInput" placeholder="Your Name">
<input id="ageInput" type="number" placeholder="Your Age">
<select id="goalInput">
<option value="">Select Goal</option>
<option value="weight loss">Weight Loss</option>
<option value="muscle gain">Muscle Gain</option>
<option value="healthy lifestyle">Healthy Lifestyle</option>
<option value="productivity">Productivity</option>
</select>
<select id="personalityInput">
<option value="hardcore">Hardcore üî•</option>
<option value="balanced">Balanced ‚öñÔ∏è</option>
<option value="chill">Chill üåø</option>
</select>
<button onclick="startApp()">Start Challenge</button>
</div>

<!-- App -->
<div id="app" style="display:none;">
<div class="card">
<h3 id="dayText"></h3>
<div>üî• Streak: <span id="streakText"></span></div>
<div>‚≠ê XP: <span id="xpText"></span></div>
<div id="xpBar"><div id="xpFill"></div></div>

<h3>üéØ Daily Task</h3>
<p id="dailyTask">Loading...</p>

<h4>üìã Extra Tasks</h4>
<div id="extraTasks"></div>

<button onclick="completeDay()">Complete Day ‚úÖ</button>

<h4>ü§ñ Ask AI Coach</h4>
<div class="aiBox">
<input id="aiInput" class="aiInput" placeholder="Type your question...">
<button class="aiButton" onclick="askAI()">Ask</button>
</div>
<div id="aiResponse"></div>

<h3>üèÖ Achievements</h3>
<div id="achievements"></div>
</div>
</div>

<div id="notify" class="notification"></div>

<audio id="levelSound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>
<audio id="completeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-positive-interface-beep-221.mp3"></audio>

<script>
const dayText = document.getElementById("dayText");
const streakText = document.getElementById("streakText");
const xpText = document.getElementById("xpText");
const xpFill = document.getElementById("xpFill");
const dailyTask = document.getElementById("dailyTask");
const extraTasks = document.getElementById("extraTasks");
const achievements = document.getElementById("achievements");
const aiResponse = document.getElementById("aiResponse");
const aiInput = document.getElementById("aiInput");
const notify = document.getElementById("notify");

// Local storage helper
function getData(){
  let d = JSON.parse(localStorage.getItem("ultraAI"));
  if(!d){
    d = {name:"",age:"",goal:"",personality:"",day:1,streak:0,xp:0,level:1,history:[],achievements:[],lastComplete:0};
  }
  return d;
}
function saveData(d){ localStorage.setItem("ultraAI", JSON.stringify(d)); }

// Start App
function startApp(){
  let d = getData();
  d.name = nameInput.value.trim();
  d.age = ageInput.value.trim();
  d.goal = goalInput.value;
  d.personality = personalityInput.value;
  saveData(d);
  setup.style.display="none";
  app.style.display="block";
  loadApp();
  generateDailyTask();
}

// Load UI
function loadApp(){
  let d = getData();
  dayText.innerText = `Day ${d.day} ‚Ä¢ Level ${d.level}`;
  streakText.innerText = d.streak;
  animateXP(d.xp,d.level);
  renderAchievements();
}

// Animate XP bar
function animateXP(xp,level){
  let percent = (xp/(level*200))*100;
  if(percent>100) percent=100;
  xpText.innerText = xp;
  xpFill.style.width = percent+"%";
}

// Daily Task
async function generateDailyTask(){
  let d = getData();
  dailyTask.innerText = "Loading...";
  try{
    const res = await fetch("/.netlify/functions/ai",{
      method:"POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({type:"daily",goal:d.goal,personality:d.personality,day:d.day,name:d.name})
    });
    const result = await res.json();
    dailyTask.innerText = result.reply || "Stay consistent today üî•";
  }catch{
    dailyTask.innerText = "Stay consistent today üî•";
  }
  generateExtraTasks();
}

// Extra Tasks
function generateExtraTasks(){
  extraTasks.innerHTML = "";
  const tasks = ["Improve 1% today","Track your progress","Stay disciplined"];
  tasks.forEach(t=>{
    extraTasks.innerHTML += `<div class="taskItem"><input type="checkbox"> ${t}</div>`;
  });
}

// Complete Day
function completeDay(){
  let d = getData();
  const now = Date.now();
  const diff = now - d.lastComplete;
  if(diff < 86400000){ showNotify("Come back tomorrow üî•"); return; }
  if(diff > 172800000) d.streak=0;
  d.day++; d.streak++; d.xp+=50;
  d.history.push(`Day ${d.day} completed`);
  document.getElementById("completeSound").play();
  if(d.xp >= d.level*200){ d.level++; d.xp=0; document.getElementById("levelSound").play(); showNotify("LEVEL UP üöÄ"); }
  unlockAchievements(d);
  d.lastComplete = now;
  saveData(d);
  loadApp();
  generateDailyTask();
  showNotify("Great job! üî•");
}

// Achievements
function unlockAchievements(d){
  const awards = {7:"7 Day Warrior",30:"30 Day Beast",100:"100 Day Legend"};
  if(awards[d.day] && !d.achievements.includes(awards[d.day])){ d.achievements.push(awards[d.day]); }
}
function renderAchievements(){
  let d = getData();
  achievements.innerHTML = "";
  d.achievements.forEach(a=>{ achievements.innerHTML += `<span class="badge">${a}</span>`; });
}

// AI Coach
async function askAI(){
  let q = aiInput.value.trim();
  if(!q) return;
  let d = getData();
  aiResponse.innerText = "Thinking... ü§ñ";
  try{
    const res = await fetch("/.netlify/functions/ai",{
      method:"POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({type:"assistant",question:q,goal:d.goal,personality:d.personality,name:d.name})
    });
    const result = await res.json();
    aiResponse.innerText = result.reply || "Stay consistent and focused üî•";
  }catch(err){
    console.error(err);
    aiResponse.innerText = "AI Coach is not available right now üî•";
  }
  aiInput.value = "";
}

// Notifications
function showNotify(msg){ notify.innerText = msg; notify.style.display="block"; setTimeout(()=>{notify.style.display="none";},2500); }

// History
function showHistory(){ let d = getData(); if(d.history.length) alert(d.history.join("\n")); else alert("No history yet."); }

// Auto-load
if(localStorage.getItem("ultraAI")){
  setup.style.display="none";
  app.style.display="block";
  loadApp();
  generateDailyTask();
}
</script>

</body>
</html>
